/******************************************************************************/
/****        Generated by IBExpert 2015.12.21.1 24/02/2024 20:21:22        ****/
/******************************************************************************/

SET SQL DIALECT 3;

SET NAMES WIN1252;

SET CLIENTLIB 'C:\Firebird\Firebird_3_0\fbclient.dll';

CREATE DATABASE 'C:\Desen\Delphi\crud-01\AvaliacaoDelphi\db\PESSOAS.FDB'
USER 'SYSDBA' PASSWORD 'masterkey'
PAGE_SIZE 16384
DEFAULT CHARACTER SET WIN1252 COLLATION WIN1252;



/******************************************************************************/
/****                              Generators                              ****/
/******************************************************************************/

CREATE GENERATOR GEN_PFISICA_ID START WITH 0 INCREMENT BY 1;
SET GENERATOR GEN_PFISICA_ID TO 6;

CREATE GENERATOR GEN_PJURIDICA_ID START WITH 0 INCREMENT BY 1;
SET GENERATOR GEN_PJURIDICA_ID TO 4;



/******************************************************************************/
/****                                Tables                                ****/
/******************************************************************************/



CREATE TABLE PFISICA (
    ID    INTEGER NOT NULL,
    NOME  VARCHAR(100) NOT NULL,
    CPF   VARCHAR(20) NOT NULL
);

CREATE TABLE PJURIDICA (
    ID        INTEGER NOT NULL,
    NOME      VARCHAR(100) NOT NULL,
    CNPJ      VARCHAR(20) NOT NULL,
    EMAIL     VARCHAR(100),
    TELEFONE  VARCHAR(20),
    CELULAR   VARCHAR(20),
    ENDERECO  VARCHAR(100),
    BAIRRO    VARCHAR(50),
    CIDADE    VARCHAR(50),
    UF        CHAR(2),
    CEP       CHAR(10)
);

CREATE TABLE VINCULO (
    ID_PJURIDICA  INTEGER NOT NULL,
    ID_PFISICA    INTEGER NOT NULL
);

INSERT INTO PFISICA (ID, NOME, CPF) VALUES (1, 'PATETA', '123456');
INSERT INTO PFISICA (ID, NOME, CPF) VALUES (2, 'PATO DONALD', '963');
INSERT INTO PFISICA (ID, NOME, CPF) VALUES (3, 'PLUTO', '321');
INSERT INTO PFISICA (ID, NOME, CPF) VALUES (5, 'BATMAN', '963147');
INSERT INTO PFISICA (ID, NOME, CPF) VALUES (6, 'ROBBIN', '852321');

COMMIT WORK;

INSERT INTO PJURIDICA (ID, NOME, CNPJ, EMAIL, TELEFONE, CELULAR, ENDERECO, BAIRRO, CIDADE, UF, CEP) VALUES (1, 'WALT DISNEY', '98049498', 'pateta@disney.com', '9852', '8704', 'DISNEY', 'ORLANDO', 'FLORIDA', 'MI', '98098794  ');
INSERT INTO PJURIDICA (ID, NOME, CNPJ, EMAIL, TELEFONE, CELULAR, ENDERECO, BAIRRO, CIDADE, UF, CEP) VALUES (2, 'DC COMICS', '98049498', 'batman@dccomics.com', '123', '456', 'GOTHAM CITY', 'GOT', 'GOTHAM', 'MI', '02514404  ');
INSERT INTO PJURIDICA (ID, NOME, CNPJ, EMAIL, TELEFONE, CELULAR, ENDERECO, BAIRRO, CIDADE, UF, CEP) VALUES (3, 'HANNA BARBERA', '8541201700', 'the_jetsons@hannabarbera.com', '654789', '123654', 'WARNER BROS', 'LOS ANGELES', 'CALIFORNIA EUA', 'MI', '98098794  ');

COMMIT WORK;

INSERT INTO VINCULO (ID_PJURIDICA, ID_PFISICA) VALUES (2, 5);
INSERT INTO VINCULO (ID_PJURIDICA, ID_PFISICA) VALUES (1, 3);
INSERT INTO VINCULO (ID_PJURIDICA, ID_PFISICA) VALUES (2, 0);
INSERT INTO VINCULO (ID_PJURIDICA, ID_PFISICA) VALUES (2, 6);
INSERT INTO VINCULO (ID_PJURIDICA, ID_PFISICA) VALUES (3, 1);
INSERT INTO VINCULO (ID_PJURIDICA, ID_PFISICA) VALUES (3, 5);

COMMIT WORK;



/******************************************************************************/
/****                             Primary keys                             ****/
/******************************************************************************/

ALTER TABLE PFISICA ADD CONSTRAINT PK_PFISICA PRIMARY KEY (ID);
ALTER TABLE PJURIDICA ADD CONSTRAINT PK_PJURIDICA PRIMARY KEY (ID);
ALTER TABLE VINCULO ADD CONSTRAINT PK_VINCULO PRIMARY KEY (ID_PJURIDICA, ID_PFISICA);


/******************************************************************************/
/****                               Triggers                               ****/
/******************************************************************************/



SET TERM ^ ;



/******************************************************************************/
/****                         Triggers for tables                          ****/
/******************************************************************************/



/* Trigger: PFISICA_BI */
CREATE TRIGGER PFISICA_BI FOR PFISICA
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if ((new.id is null) or (new.id = 0))  then
    new.id = gen_id(gen_pfisica_id,1);
end
^

/* Trigger: PJURIDICA_BI */
CREATE TRIGGER PJURIDICA_BI FOR PJURIDICA
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if (new.id is null) then
    new.id = gen_id(gen_pjuridica_id,1);
end
^
SET TERM ; ^
